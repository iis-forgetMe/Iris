<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="icon" type="image/png" href="OwO.png">
    <title>Iris</title>
    
    <meta property="og:title" content="Iris" />
    <meta property="og:description" content="You're my light." />
    <meta property="og:image" content="https://raw.githubusercontent.com/iis-forgetMe/Iris/main/Artful.jpg" />

    <style>
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            min-height: 100vh;
            overflow-x: hidden; 
            touch-action: pan-y;
        }
        @font-face {
            font-family: 'OMORI';
            src: url('OMORI_GAME2.ttf') format('truetype');
        }
        
        body {
            font-family: 'OMORI', Arial, sans-serif;
            background-color: #000;
            color: #F5F5F5;
            font-size: 20px !important;
            word-break: keep-all;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            user-select: none;
            -webkit-user-select: none; -ms-user-select: none;
        }
        body.comic-sans { font-family: "Comic Sans MS", "Comic Sans", cursive !important;
            font-size: 20px !important;}
        
        #video-bg {
            position: fixed;
            right: 0; bottom: 0; min-width: 100vw; min-height: 100vh; width: 100vw; height: 100vh;
            object-fit: cover; object-position: center center; z-index: -1;
            background: #000; pointer-events: none; filter: brightness(0.5); left: 0; top: 0;
            transition: opacity 1s; opacity: 0;
        }
        #video-bg.video-active { opacity: 1;
        }

        #main-interface {
            position: absolute;
            top: 0; left: 0;
            opacity: 0;
            pointer-events: none;
            transition: opacity 1.5s ease-in-out;
            width: 100%;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 80px 0;
            box-sizing: border-box;
        }
        #main-interface.active-interface {
            opacity: 1;
            pointer-events: auto;
        }
        
        .centered-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 90%; 
            max-width: 700px;
            position: relative; 
        }

        #card-selection-screen {
            position: relative;
            width: 100%; 
            min-height: 100vh;
            background: #000; z-index: 500;
            display: none; 
            flex-direction: row; 
            justify-content: center; 
            align-items: center;
            opacity: 0;
            transition: opacity 0.8s ease;
        }
        
        .cards-wrapper {
            position: relative;
            width: 100%;
            height: 400px;
            display: flex;
            justify-content: center;
            align-items: center;
            perspective: 1000px;
        }

        .card {
            width: 280px;
            height: 280px;
            border-radius: 12px;
            background: #000; 
            border: none;
            box-shadow: none;
            box-sizing: border-box;
            overflow: hidden;
            position: absolute;
            transition: all 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .card img {
            width: 100%;
            height: 100%;
            object-fit: cover; 
            display: block;
            border-radius: 10px;
            pointer-events: none;
        }

        @media (min-width: 901px) {
            .card[data-status="active"] {
                transform: translateX(0) scale(1.1);
                z-index: 10;
                filter: brightness(1);
                opacity: 1;
                box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
            }
            .card[data-status="left"] {
                transform: translateX(-110%) scale(0.85);
                z-index: 5;
                filter: brightness(0.4);
                opacity: 0.7;
            }
            .card[data-status="right"] {
                transform: translateX(110%) scale(0.85);
                z-index: 5;
                filter: brightness(0.4);
                opacity: 0.7;
            }
            .card[data-status="hidden"] {
                transform: translateX(0) scale(0.5);
                z-index: 1;
                opacity: 0;
                pointer-events: none;
            }
        }

        @media (max-width: 900px) {
            #card-selection-screen {
                flex-direction: column;
                align-items: center;
                justify-content: flex-start;
                padding-top: 80px; 
                padding-bottom: 50px;
                height: auto; 
                overflow-y: visible;
            }
            
            .cards-wrapper {
                flex-direction: column;
                height: auto;
                perspective: none;
                gap: 20px;
                padding-bottom: 40px;
            }

            .card {
                position: relative;
                transform: none !important; 
                opacity: 1 !important;
                filter: brightness(1) !important;
                margin-bottom: 20px;
                left: auto;
                right: auto;
                top: auto;
                bottom: auto;
            }
        }

        .back-button-controller {
            position: fixed;
            left: 24px; top: 76px; z-index: 22; display: flex; align-items: center; justify-content: center;
            background: rgba(40, 40, 40, 0.74); border-radius: 999px;
            box-shadow: 0 3px 18px 0 #0007; padding: 4px; 
            width: 32px; height: 32px; cursor: pointer;
            transition: opacity 1.5s ease-in-out, transform 0.2s ease;
            opacity: 0;
            pointer-events: none;
        }
        .back-button-controller.visible { opacity: 1; pointer-events: auto;
        }
        .back-button-controller:hover { transform: scale(1.1);
        }
        .back-icon { width: 24px; height: 24px; display: flex; align-items: center; justify-content: center;
            transform: translateX(1px); }

        .top-box {
            position: fixed;
            left: 28px; right: 28px; top: 20px; z-index: 22; min-height: 44px; display: flex; align-items: center;
            justify-content: space-between;
            background: rgba(40, 40, 40, 0.74); border-radius: 999px; box-shadow: 0 3px 18px 0 #0007;
            padding: 0 32px; font-size: 22px; font-family: inherit;
            color: #F5F5F5; width: auto;
        }
        .top-box-left { font-weight: bold; font-size: 22px; padding-right: 28px;
        }
        .top-box-right { min-width: 32px; display: flex; align-items: center;
        }
        .top-box-right .icon-link { display: inline-flex; align-items: center; margin-left: 16px;
            transition: transform 0.2s;}
        .top-box-right .icon-link:first-child {margin-left: 0;}
        .social-icon { display: block;
            filter: brightness(0.99) drop-shadow(0 2px 4px #0007); transition: filter 0.2s, transform 0.2s; 
            width: 28px; height: 28px; 
            -webkit-user-drag: none; user-select: none;
        }
        .icon-link:hover .social-icon { filter: brightness(1.2) drop-shadow(0 2px 5px #fff7);
            transform: scale(1.1);}
        
        .volume-controller {
            position: fixed;
            left: 24px; bottom: 24px; z-index: 20; display: flex; align-items: center; gap: 0;
            background: rgba(40, 40, 40, 0.74); border-radius: 999px;
            box-shadow: 3px 3px 18px 0 #0007; padding: 6px; /* Increased shadow for better visibility */
            width: 44px; height: 44px; transition: width 0.4s; overflow: visible;
        }
        .volume-icon { cursor: pointer; outline: none; user-select: none; display: flex; align-items: center;
            justify-content: center; width: 32px; height: 32px; margin-left: 8px; }
        .volume-icon svg { fill: #fff; } 
        .volume-slider, .volume-percent { opacity: 0;
            pointer-events: none; transition: opacity 0.44s; transition-delay: 0s; }
        .volume-controller:hover, .volume-controller:focus-within { width: 180px;}
        .volume-controller:hover .volume-slider,
        .volume-controller:focus-within .volume-slider,
        .volume-controller:hover .volume-percent,
        .volume-controller:focus-within .volume-percent {
            opacity: 1;
            pointer-events: auto; transition-delay: 0.38s;
        }
        .volume-slider { width: 90px; max-width: 36vw; margin-left: 12px;
            accent-color: #f00;} 
        .volume-percent { color: #fff; min-width: 32px; text-align: right; font-family: inherit;
            font-size: 15px; margin-left: 8px;}

        #video-volume-slider-input::-webkit-slider-runnable-track {
            width: 100%;
            height: 2px;
            background: #4f4f4f;
            border-radius: 1px;
        }
        #video-volume-slider-input::-webkit-slider-thumb {
            height: 10px;
            width: 10px;
            border-radius: 50%;
            background: #f00; 
            -webkit-appearance: none;
            margin-top: -4px; 
            box-shadow: 0 0 5px rgba(0,0,0,0.5);
        }
        #video-volume-slider-input {
            accent-color: #f00;
        }

        /* --- WRAPPERS FOR OVERLAY ANIMATION --- */
        #content-layer {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            /* No animation on content layer */
        }
        
        #queue-overlay {
            position: absolute;
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            z-index: 50;
            display: flex;
            flex-direction: column;
            
            /* Start invisible and off-screen to the right */
            opacity: 0;
            pointer-events: none;
            transform: translateX(100%); 
            
            transition: 
                opacity 0.4s ease-out, /* Fade in */
                transform 0.5s cubic-bezier(0.2, 0.8, 0.2, 1); /* Slide in */
            
            /* Styling (Matching the other blocks) */
            background: linear-gradient(to right, #008398, #74003e);
            border-radius: 16px;
            padding: 3px;
            box-shadow: 
                0 0 20px 0 rgba(0, 131, 152, 0.8), 
                0 0 40px 0 rgba(116, 0, 62, 0.5);
        }

        #queue-overlay.active {
            opacity: 1;
            pointer-events: auto;
            transform: translateX(0); /* Slide to center */
        }

        .queue-inner-content {
            background-color: rgba(20, 20, 20, 0.95);
            width: 100%;
            height: 100%;
            border-radius: 14px;
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- MAIN BLOCKS --- */
        #discord-profile-container {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            width: 100%; 
            height: auto; 
            min-height: 250px; 
            background: linear-gradient(to right, #008398, #74003e);
            backdrop-filter: blur(12px);
            border-radius: 16px;
            box-shadow: 
                0 0 20px 0 rgba(0, 131, 152, 0.8), 
                0 0 40px 0 rgba(116, 0, 62, 0.5);
            border: none;
            overflow: hidden;
            margin-bottom: 25px;
        }
        
        .discord-main-block {
            width: 100%;
            flex-shrink: 0;
            position: relative;
            background-color: rgba(20, 20, 20, 0.85); 
            display: flex;
            flex-direction: column;
            overflow-y: visible; 
            padding-bottom: 20px;
            z-index: 1;
        }

        .discord-activity-box, .tab-bar { display: none !important;
        }

        .discord-banner {
            width: 100%;
            height: 120px; 
            background-size: cover; background-position: center;
            background-color: #333; flex-shrink: 0; position: relative;
        }

        .profile-content { padding: 0 20px; margin-top: -60px;
        }
        
        .discord-avatar-container {
            position: relative;
            width: 92px; height: 92px; flex-shrink: 0; border-radius: 50%;
            z-index: 10; border: none; background-color: #1a1a1a; overflow: visible !important;
        }
        
        .discord-avatar {
            width: 92px;
            height: 92px; margin: 0; border-radius: 50%; object-fit: cover;
            position: relative; z-index: 15; pointer-events: none; -webkit-user-drag: none;
            user-select: none; border: none;
            box-sizing: border-box;
        }

        #avatar-frame-overlay {
            position: absolute;
            top: -11px; left: -11px; width: 114px; height: 114px; 
            border-radius: 0; background-image: url('Aurora Fox.gif');
            background-size: cover; background-position: center; z-index: 16;
            pointer-events: none; 
        }

        .discord-username {
            font-size: 28px;
            font-weight: normal; font-family: 'OMORI', monospace; 
            margin: 10px 0 2px 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
            background-image: linear-gradient(to right, #ba98ff, #acfdff);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-clip: text; text-fill-color: transparent;
        }
        .discord-tag { font-size: 15px; color: #b9bbbe; margin-bottom: 5px;
        }
        
        .discord-badges-container { display: flex;
            align-items: center; margin-bottom: 15px; height: 24px; }
        .discord-badge {
            width: 24px;
            height: 24px; margin-right: 6px; display: inline-block;
            filter: drop-shadow(0 0 2px rgba(0,0,0,0.5)); -webkit-user-drag: none; user-select: none;
        }

        .discord-bio-box { display: none;
        }
        .info-section { display: none;
        }
        .tab-content-wrapper { padding: 0 20px 20px 20px; overflow: visible;
        }
        
        .music-player-box {
            width: 100%;
            background: linear-gradient(to right, #008398, #74003e);
            border-radius: 16px;
            padding: 3px;
            box-shadow: 
                0 0 20px 0 rgba(0, 131, 152, 0.8), 
                0 0 40px 0 rgba(116, 0, 62, 0.5);
            display: flex; flex-direction: column;
        }

        .music-player-inner {
            background-color: rgba(20, 20, 20, 0.95);
            width: 100%;
            height: 100%;
            border-radius: 14px;
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .player-cover {
            width: 100px;
            height: 100px;
            border-radius: 8px;
            object-fit: cover;
            flex-shrink: 0;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }

        .player-info {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            overflow: hidden;
        }

        .track-title {
            font-size: 20px;
            font-weight: bold;
            color: #fff;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 4px;
        }

        .track-artist {
            font-size: 14px;
            color: #b3b3b3;
            margin-bottom: 12px;
        }

        .player-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 8px;
        }

        .control-btn {
            background: none;
            border: none; cursor: pointer;
            color: #fff; 
            display: flex; align-items: center; justify-content: center;
            transition: color 0.2s, transform 0.2s;
            padding: 0;
        }
        .control-btn:hover { color: #f00; transform: scale(1.1);
        }
        .control-btn svg { width: 24px; height: 24px; fill: currentColor;
        }
        .control-btn.play-pause svg { width: 32px; height: 32px;
        }

        .progress-container {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 100%;
            font-size: 12px;
            color: #b3b3b3;
            font-family: monospace;
        }

        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
            cursor: pointer;
        }
        input[type=range]:focus { outline: none;
        }
        
        #seek-bar::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            background: #4f4f4f;
            border-radius: 2px;
        }
        #seek-bar::-webkit-slider-thumb {
            height: 12px;
            width: 12px;
            border-radius: 50%;
            background: #f00; 
            -webkit-appearance: none;
            margin-top: -4px; 
            box-shadow: 0 0 5px rgba(0,0,0,0.5);
            opacity: 1; 
        }

        #seek-bar {
            accent-color: #f00;
        }

        #player-volume-slider::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            background: #4f4f4f; 
            border-radius: 2px;
        }
        #player-volume-slider::-webkit-slider-thumb {
            height: 12px;
            width: 12px;
            border-radius: 50%;
            background: #f00; 
            -webkit-appearance: none;
            margin-top: -4px; 
            box-shadow: 0 0 5px rgba(0,0,0,0.5);
        }
        #player-volume-slider {
            accent-color: #f00;
        }

        .player-volume {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 120px;
            flex-shrink: 0;
        }
        .player-volume input { width: 100%;
        }
        .player-volume-percent-label {
            color: #fff; min-width: 32px; text-align: right; font-family: monospace;
            font-size: 12px; margin-left: 0;
        }
        .player-volume #player-mute-btn svg { fill: #fff; 
        }

        @media (max-width: 900px) {
            #discord-profile-container { 
                min-height: auto; 
                height: auto; 
                margin-top: 0; 
            }
            .discord-main-block { padding-bottom: 10px;
            }
            .profile-content { padding: 0 15px;
            }
            .tab-content-wrapper { padding: 0 15px 15px 15px;
            }
            
            .music-player-inner {
                flex-direction: column;
                text-align: center;
                gap: 15px;
                padding: 25px 15px;
            }
            .player-cover { width: 140px;
                height: 140px; margin-bottom: 5px; }
            .player-info { width: 100%;
            }
            .player-controls { justify-content: center; margin-bottom: 15px;
            }
            .player-volume { display: none;
            }
            
            .centered-content { width: 95%; max-width: 95%;}
        }

        /* --- STYLES INSIDE QUEUE OVERLAY --- */
        .queue-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .queue-title {
            font-size: 18px;
            font-weight: bold;
            color: #fff;
        }
        .queue-close-btn {
            background: none;
            border: none;
            color: #aaa;
            cursor: pointer;
            padding: 5px;
            transition: color 0.2s;
        }
        .queue-close-btn:hover {
            color: #fff;
        }
        .queue-list {
            flex-grow: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 8px;
            padding-right: 5px;
        }
        .queue-list::-webkit-scrollbar { width: 4px; }
        .queue-list::-webkit-scrollbar-thumb { background: #555; border-radius: 2px; }
        
        .queue-item {
            display: flex;
            align-items: center;
            padding: 8px;
            border-radius: 6px;
            background: rgba(255,255,255,0.05);
            transition: background 0.2s;
            cursor: pointer;
        }
        .queue-item:hover {
            background: rgba(255,255,255,0.1);
        }
        .queue-item.active {
            background: rgba(0, 131, 152, 0.3);
            border: 1px solid rgba(0, 131, 152, 0.5);
        }
        .q-thumb {
            width: 40px; height: 40px; border-radius: 4px; object-fit: cover; margin-right: 10px;
        }
        .q-info { display: flex; flex-direction: column; overflow: hidden; }
        .q-title { font-size: 14px; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-weight: bold; }
        .q-artist { font-size: 12px; color: #bbb; }

    </style>
</head>
<body>

    <video id="video-bg" autoplay muted loop playsinline>
        <source src="" type="video/mp4">
    </video>

    <div id="card-selection-screen">
        <div class="cards-wrapper" id="cards-container">
            </div>
    </div>

    <div class="back-button-controller" id="back-to-menu-btn" onclick="backToMenu()">
        <div class="back-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px; height: 20px;">
                <line x1="19" y1="12" x2="5" y2="12"></line>
                <polyline points="12 19 5 12 12 5"></polyline>
            </svg>
        </div>
    </div>

    <div class="volume-controller">
        <div class="volume-icon" id="video-mute-btn">
             <svg viewBox="0 0 24 24" style="width:24px;height:24px;"><path d="M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16.02C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z" /></svg>
        </div>
        <input type="range" id="video-volume-slider-input" class="volume-slider" min="0" max="1" step="0.01" value="0">
        <div class="volume-percent" id="video-volume-text">0%</div>
    </div>

    <div class="top-box">
        <div class="top-box-left" id="top-box-title">OMORI</div>
        <div class="top-box-right">
            <a href="https://t.me/Au_rora_Fox" target="_blank" class="icon-link">
                <img src="telegram.png" alt="TG" class="social-icon">
            </a>
            <a href="https://steamcommunity.com/id/Aurora_Fox/" target="_blank" class="icon-link">
                <img src="steam.png" alt="Steam" class="social-icon">
            </a>
            <a href="https://discord.com/users/1112431763784863804" target="_blank" class="icon-link">
                <img src="discord.png" alt="DS" class="social-icon">
            </a>
            <a href="https://open.spotify.com/user/31g226332k35f455i355v5y25a7i" target="_blank" class="icon-link">
                <img src="Spotify.png" alt="Spotify" class="social-icon">
            </a>
            <a href="https://github.com/iis-forgetMe" target="_blank" class="icon-link">
                <img src="github.png" alt="Git" class="social-icon">
            </a>
        </div>
    </div>

    <div id="main-interface">
        <div class="centered-content">
            
            <div id="content-layer">
                <div id="discord-profile-container">
                    <div class="discord-main-block">
                         <div class="discord-banner" style="background-image: url('banner.gif');"></div>
                         <div class="profile-content">
                             <div class="discord-avatar-container">
                                 <img src="avatar.gif" alt="Avatar" class="discord-avatar">
                                 <div id="avatar-frame-overlay"></div>
                             </div>
                             <div class="discord-username">Aurora Fox</div>
                             <div class="discord-tag">aurora_fox_</div>
                             <div class="discord-badges-container">
                                 <img src="badge1.png" class="discord-badge" title="Badge 1">
                                 <img src="badge2.png" class="discord-badge" title="Badge 2">
                             </div>
                         </div>
                    </div>
                </div>

                <div class="music-player-box">
                    <div class="music-player-inner">
                        <img id="player-cover" src="cover.jpg" alt="Cover" class="player-cover">
                        <div class="player-info">
                            <div class="track-title" id="track-title">Track Title</div>
                            <div class="track-artist" id="track-artist">Artist</div>
                            <div class="player-controls">
                                <button class="control-btn" id="prev-btn">
                                    <svg viewBox="0 0 24 24"><path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/></svg>
                                </button>
                                <button class="control-btn play-pause" id="play-pause-btn">
                                    <svg id="play-icon" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                                    <svg id="pause-icon" viewBox="0 0 24 24" style="display:none"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                                </button>
                                <button class="control-btn" id="next-btn">
                                    <svg viewBox="0 0 24 24"><path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/></svg>
                                </button>
                                <button class="control-btn" id="queue-btn" onclick="toggleQueue()">
                                    <svg viewBox="0 0 24 24"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/></svg>
                                </button>
                            </div>
                            <div class="progress-container">
                                <span id="current-time">0:00</span>
                                <input type="range" id="seek-bar" value="0" min="0" max="100" step="0.1">
                                <span id="duration">0:00</span>
                            </div>
                        </div>
                        <div class="player-volume">
                             <div class="control-btn" id="player-mute-btn" style="cursor:pointer;">
                                <svg viewBox="0 0 24 24" style="width:20px;height:20px;"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>
                             </div>
                             <input type="range" id="player-volume-slider" min="0" max="1" step="0.01" value="0.5">
                             <div class="player-volume-percent-label" id="player-vol-text">50%</div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="queue-overlay">
                <div class="queue-inner-content">
                    <div class="queue-header">
                        <span class="queue-title">Queue</span>
                        <button class="queue-close-btn" onclick="toggleQueue()">
                            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                                <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="queue-list" id="queue-list-container">
                        </div>
                </div>
            </div>

        </div>
    </div>
    
    <script>
        const cardsData = [
            { title: "OMORI", img: "omori.jpg", video: "omori_video.mp4", music: "omori_music.mp3", author: "OMORI", avatar: "omori_avatar.png" },
            { title: "Nier", img: "nier.jpg", video: "nier_video.mp4", music: "nier_music.mp3", author: "Nier Automata", avatar: "nier_avatar.png" },
            { title: "Genshin", img: "genshin.jpg", video: "genshin_video.mp4", music: "genshin_music.mp3", author: "Genshin Impact", avatar: "genshin_avatar.png" },
            { title: "Hollow Knight", img: "hollow.jpg", video: "hollow_video.mp4", music: "hollow_music.mp3", author: "Hollow Knight", avatar: "hollow_avatar.png" }
        ];

        let activeCardIndex = 0;
        let isInterfaceActive = false;
        
        const cardSelectionScreen = document.getElementById('card-selection-screen');
        const cardsContainer = document.getElementById('cards-container');
        const mainInterface = document.getElementById('main-interface');
        const videoBg = document.getElementById('video-bg');
        const backBtn = document.getElementById('back-to-menu-btn');
        const topTitle = document.getElementById('top-box-title');
        
        // Player Elements
        const trackTitleEl = document.getElementById('track-title');
        const trackArtistEl = document.getElementById('track-artist');
        const playerCoverEl = document.getElementById('player-cover');
        const playPauseBtn = document.getElementById('play-pause-btn');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');
        const seekBar = document.getElementById('seek-bar');
        const currentTimeEl = document.getElementById('current-time');
        const durationEl = document.getElementById('duration');
        const playerVolSlider = document.getElementById('player-volume-slider');
        const playerVolText = document.getElementById('player-vol-text');
        const playerMuteBtn = document.getElementById('player-mute-btn');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        
        // Video Volume Elements
        const vidVolSlider = document.getElementById('video-volume-slider-input');
        const vidVolText = document.getElementById('video-volume-text');
        const vidMuteBtn = document.getElementById('video-mute-btn');

        let audio = new Audio();
        let isPlaying = false;
        let currentTrackIndex = 0;
        
        // Initial Video Volume State
        videoBg.volume = 0;
        vidVolSlider.value = 0;
        vidVolText.innerText = "0%";
        
        // Init Cards
        function initCards() {
            cardsContainer.innerHTML = '';
            cardsData.forEach((data, index) => {
                const card = document.createElement('div');
                card.classList.add('card');
                card.innerHTML = `<img src="${data.img}" alt="${data.title}">`;
                card.onclick = () => selectCard(index);
                cardsContainer.appendChild(card);
            });
            updateCardsVisual();
            cardSelectionScreen.style.display = 'flex';
            setTimeout(() => cardSelectionScreen.style.opacity = '1', 50);
        }

        function updateCardsVisual() {
            const cards = document.querySelectorAll('.card');
            cards.forEach((card, index) => {
                card.removeAttribute('data-status');
                if (window.innerWidth > 900) {
                    if (index === activeCardIndex) card.setAttribute('data-status', 'active');
                    else if (index === activeCardIndex - 1) card.setAttribute('data-status', 'left');
                    else if (index === activeCardIndex + 1) card.setAttribute('data-status', 'right');
                    else card.setAttribute('data-status', 'hidden');
                } else {
                    card.style.transform = 'none'; 
                    card.style.opacity = '1';
                }
            });
        }

        function selectCard(index) {
            if (window.innerWidth > 900 && index !== activeCardIndex) {
                activeCardIndex = index;
                updateCardsVisual();
                return;
            }
            
            const selected = cardsData[index];
            currentTrackIndex = index;
            loadTrack(index);

            // Change Video
            videoBg.src = selected.video;
            videoBg.load();
            videoBg.play().catch(()=>{});
            videoBg.classList.add('video-active');

            // Hide Selection, Show Interface
            cardSelectionScreen.style.opacity = '0';
            setTimeout(() => {
                cardSelectionScreen.style.display = 'none';
                mainInterface.classList.add('active-interface');
                backBtn.classList.add('visible');
                isInterfaceActive = true;
                topTitle.innerText = selected.title;
            }, 800);
        }

        function backToMenu() {
            isInterfaceActive = false;
            mainInterface.classList.remove('active-interface');
            backBtn.classList.remove('visible');
            videoBg.classList.remove('video-active');
            
            // Close queue if open
            const queueOverlay = document.getElementById('queue-overlay');
            if(queueOverlay.classList.contains('active')){
                queueOverlay.classList.remove('active');
            }

            audio.pause();
            isPlaying = false;
            updatePlayIcon();
            
            setTimeout(() => {
                videoBg.pause();
                videoBg.src = "";
                cardSelectionScreen.style.display = 'flex';
                setTimeout(() => cardSelectionScreen.style.opacity = '1', 50);
            }, 1000);
        }
        
        // --- QUEUE LOGIC ---
        function toggleQueue() {
            const queueOverlay = document.getElementById('queue-overlay');
            // contentLayer больше не нужен для изменения opacity/filter, но оставим для справки
            // const contentLayer = document.getElementById('content-layer'); 
            const isActive = queueOverlay.classList.contains('active');

            if (!isActive) {
                renderQueue(); // Refresh list
                queueOverlay.classList.add('active');
            } else {
                queueOverlay.classList.remove('active');
            }
        }

        function renderQueue() {
            const listContainer = document.getElementById('queue-list-container');
            listContainer.innerHTML = '';
            cardsData.forEach((track, idx) => {
                const item = document.createElement('div');
                item.className = 'queue-item' + (idx === currentTrackIndex ? ' active' : '');
                item.onclick = () => {
                    currentTrackIndex = idx;
                    loadTrack(idx);
                    if(isPlaying) audio.play();
                    renderQueue();
                };
                item.innerHTML = `
                    <img src="${track.img}" class="q-thumb">
                    <div class="q-info">
                        <div class="q-title">${track.title}</div>
                        <div class="q-artist">${track.author}</div>
                    </div>
                `;
                listContainer.appendChild(item);
            });
        }

        // --- AUDIO PLAYER LOGIC ---
        function loadTrack(index) {
            const track = cardsData[index];
            audio.src = track.music;
            audio.load();
            trackTitleEl.innerText = track.title;
            trackArtistEl.innerText = track.author;
            playerCoverEl.src = track.img;
            
            // Reset Progress
            seekBar.value = 0;
            currentTimeEl.innerText = "0:00";
            
            // Update Queue highlight if open
            const qItems = document.querySelectorAll('.queue-item');
            if(qItems.length > 0) {
                qItems.forEach(el => el.classList.remove('active'));
                if(qItems[index]) qItems[index].classList.add('active');
            }
        }

        playPauseBtn.addEventListener('click', () => {
            if (isPlaying) {
                audio.pause();
                isPlaying = false;
            } else {
                audio.play();
                isPlaying = true;
            }
            updatePlayIcon();
        });

        function updatePlayIcon() {
            if (isPlaying) {
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'block';
            } else {
                playIcon.style.display = 'block';
                pauseIcon.style.display = 'none';
            }
        }

        audio.addEventListener('timeupdate', () => {
            if(audio.duration) {
                const pct = (audio.currentTime / audio.duration) * 100;
                seekBar.value = pct;
                
                let curMins = Math.floor(audio.currentTime / 60);
                let curSecs = Math.floor(audio.currentTime % 60);
                if (curSecs < 10) curSecs = '0' + curSecs;
                currentTimeEl.innerText = `${curMins}:${curSecs}`;
                
                let durMins = Math.floor(audio.duration / 60);
                let durSecs = Math.floor(audio.duration % 60);
                if (durSecs < 10) durSecs = '0' + durSecs;
                durationEl.innerText = `${durMins}:${durSecs}`;
            }
        });

        audio.addEventListener('ended', () => {
             nextBtn.click();
        });

        seekBar.addEventListener('input', () => {
            if(audio.duration) {
                const seekTime = (seekBar.value / 100) * audio.duration;
                audio.currentTime = seekTime;
            }
        });

        prevBtn.addEventListener('click', () => {
            currentTrackIndex--;
            if (currentTrackIndex < 0) currentTrackIndex = cardsData.length - 1;
            loadTrack(currentTrackIndex);
            if (isPlaying) audio.play();
        });

        nextBtn.addEventListener('click', () => {
            currentTrackIndex++;
            if (currentTrackIndex >= cardsData.length) currentTrackIndex = 0;
            loadTrack(currentTrackIndex);
            if (isPlaying) audio.play();
        });

        // Player Volume
        playerVolSlider.addEventListener('input', (e) => {
            const val = e.target.value;
            audio.volume = val;
            playerVolText.innerText = Math.round(val * 100) + '%';
        });
        
        playerMuteBtn.addEventListener('click', () => {
            if(audio.muted) {
                audio.muted = false;
                playerVolText.style.color = "#fff";
            } else {
                audio.muted = true;
                playerVolText.style.color = "#f00";
            }
        });

        // Video Volume
        vidVolSlider.addEventListener('input', (e) => {
            const val = e.target.value;
            videoBg.volume = val;
            vidVolText.innerText = Math.round(val * 100) + '%';
        });
        vidMuteBtn.addEventListener('click', () => {
            if (videoBg.muted) {
                videoBg.muted = false;
                vidVolText.style.color = "#fff";
            } else {
                videoBg.muted = true;
                vidVolText.style.color = "#f00";
            }
        });

        // Keyboard & Wheel Support for cards
        document.addEventListener('keydown', (e) => {
            if (!isInterfaceActive) {
                if (e.key === 'ArrowRight') {
                    if (activeCardIndex < cardsData.length - 1) {
                        activeCardIndex++;
                        updateCardsVisual();
                    }
                } else if (e.key === 'ArrowLeft') {
                    if (activeCardIndex > 0) {
                        activeCardIndex--;
                        updateCardsVisual();
                    }
                } else if (e.key === 'Enter') {
                    selectCard(activeCardIndex);
                }
            }
        });

        cardsContainer.addEventListener('wheel', (e) => {
            if (!isInterfaceActive && window.innerWidth > 900) {
                if (e.deltaY > 0) {
                    if (activeCardIndex < cardsData.length - 1) {
                        activeCardIndex++;
                        updateCardsVisual();
                    }
                } else {
                    if (activeCardIndex > 0) {
                        activeCardIndex--;
                        updateCardsVisual();
                    }
                }
            }
        });

        // Title Animation
        let phrases = [
            "Welcome to the space.",
            "Choose your destiny.",
            "Music satisfies the soul.",
            "Aurora Fox presents..."
        ];
        let phrase = "";
        let displayText = "";
        let index = 0;
        let direction = 1; 
        let cursorVisible = true;
        let lastIndex = -1;

        const typeSpeed = 100;
        const deleteSpeed = 50;
        const pauseSpeed = 2000;
        const blankPause = 500;
        const blinkSpeed = 500;

        function pickRandomPhrase() {
          let newIndex;
          do { newIndex = Math.floor(Math.random() * phrases.length); } while (newIndex === lastIndex && phrases.length > 1);
          lastIndex = newIndex;
          return phrases[newIndex];
        }
        function blinkCursor() {
          document.title = displayText + (cursorVisible ? "_" : "");
          cursorVisible = !cursorVisible;
          setTimeout(blinkCursor, blinkSpeed);
        }
        function animateTitle() {
          if (direction === 1 && index <= phrase.length) {
            displayText = phrase.slice(0, index++);
            setTimeout(animateTitle, typeSpeed);
          } else if (direction === -1 && index >= 0) {
            displayText = phrase.slice(0, index--);
            setTimeout(animateTitle, deleteSpeed); 
          } else {
            setTimeout(() => {
              if (direction === 1) { direction = -1; index = phrase.length - 1; } 
              else {
                displayText = ""; 
                setTimeout(() => { direction = 1; phrase = pickRandomPhrase(); index = 0; animateTitle(); }, blankPause);
                return;
              }
              animateTitle();
            }, pauseSpeed);
          }
        }

        // Start
        phrase = pickRandomPhrase();
        blinkCursor();
        animateTitle();
        initCards();
        
    </script>
</body>
</html>
